#include <stdio.h>
#include <string.h>

#define MAX 100

void bookLoanSystem();





int main()
{
    bookLoanSystem();
    return 0;
}






struct BookLoan {
    char date[20];
    char bookName[100];
    char authorName[100];
};


struct BookLoan loans[MAX];
int count = 0;


static void addLoan();
static void viewLoans();
static void searchLoan();



void bookLoanSystem()
{

    int choice;


    while (1) {

        printf("\n===== BOOK LOAN SYSTEM =====\n");
        printf("1. Add Book Loan\n");
        printf("2. View All Loans\n");
        printf("3. Search Loan\n");
        printf("4. Exit\n");
        printf("Enter your choice: ");
        scanf("%d", &choice);
        getchar(); 


        switch (choice) {
            case 1: addLoan(); break;
            case 2: viewLoans(); break;
            case 3: searchLoan(); break;
            case 4: 
                printf("Exiting program...\n");
                return;
            default:
                printf("Invalid option! Try again.\n");
        }
    }

    return;
}



//add loan


static void addLoan() {

    if (count >= MAX) {
    printf("Cannot add more loans. Storage full.\n");
    return;
    }

    
    printf("\n--- Add Book Loan ---\n");

    printf("Enter date (DD/MM/YY): ");
    fgets(loans[count].date, sizeof(loans[count].date), stdin);
    loans[count].date[strcspn(loans[count].date, "\n")] = 0;



    printf("Enter book name: ");
    fgets(loans[count].bookName, sizeof(loans[count].bookName), stdin);
    loans[count].bookName[strcspn(loans[count].bookName, "\n")] = 0;



    printf("Enter author name: ");
    fgets(loans[count].authorName, sizeof(loans[count].authorName), stdin);
    loans[count].authorName[strcspn(loans[count].authorName, "\n")] = 0;



    count++;
    printf("Book loan added successfully!\n");
}

//view loans


static void viewLoans() {
    printf("\n--- All Book Loans ---\n");



    if (count == 0) {
        printf("No records found.\n");
        return;
    }



    for (int i = 0; i < count; i++) {
        printf("\nLoan #%d\n", i + 1);
        printf("Date: %s\n", loans[i].date);
        printf("Book Name: %s\n", loans[i].bookName);
        printf("Author Name: %s\n", loans[i].authorName);
    }
}


// searching loan

static void searchLoan() {
    char search[100];
    int found = 0;


    printf("\nEnter book name to search: ");
    fgets(search, sizeof(search), stdin);
    search[strcspn(search, "\n")] = 0;



    for (int i = 0; i < count; i++) {
        if (strstr(loans[i].bookName, search)) {
            printf("\n--- Match Found ---\n");
            printf("Date: %s\n", loans[i].date);
            printf("Book Name: %s\n", loans[i].bookName);
            printf("Author Name: %s\n", loans[i].authorName);
            found = 1;
        }
    }



    if (!found) {
        printf("No matching records.\n");
    }
    
}
